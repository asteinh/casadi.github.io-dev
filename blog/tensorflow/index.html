

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    
      <title>CasADi - Blog</title>
    

    
    <link href="https://asteinh.github.io/casadi.github.io-dev/_css/font-awesome.min.css" rel="stylesheet">

    
    <link href="https://asteinh.github.io/casadi.github.io-dev/_css/bootstrap.min.css" rel="stylesheet">

    
    <link href="https://asteinh.github.io/casadi.github.io-dev/_css/pygments-default.css" rel="stylesheet">

    
    <link href="https://asteinh.github.io/casadi.github.io-dev/_css/casadi-theme.min.css" rel="stylesheet">

    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ['\\(','\\)'] ],
          displayMath: [ ['$$','$$'], ['\\[','\\]'] ],
          processEnvironments: false
        }
      });
    </script>

    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
  </head>

  <body>



<nav class="navbar fixed-top navbar-expand-lg nav-top">
  <div class="container">
    <a class="navbar-brand" href="https://asteinh.github.io/casadi.github.io-dev/"></a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
      <i class="fa fa-bars" aria-hidden="true"></i>
    </button>
    <div class="collapse navbar-collapse" id="navbarNavDropdown">
      <ul class="navbar-nav">
        
        
          
          <li class="nav-item">
          
            <a class="nav-link" href="/casadi.github.io-dev/">Home</a>
          </li>
        
          
          <li class="nav-item">
          
            <a class="nav-link" href="/casadi.github.io-dev/get/">Try/Install</a>
          </li>
        
          
          <li class="nav-item active">
          
            <a class="nav-link" href="/casadi.github.io-dev/blog/">Blog</a>
          </li>
        
          
          <li class="nav-item">
          
            <a class="nav-link" href="/casadi.github.io-dev/docs/">Docs</a>
          </li>
        
          
          <li class="nav-item">
          
            <a class="nav-link" href="/casadi.github.io-dev/events/">Workshops</a>
          </li>
        
          
          <li class="nav-item">
          
            <a class="nav-link" href="/casadi.github.io-dev/support/">Support</a>
          </li>
        
          
          <li class="nav-item">
          
            <a class="nav-link" href="/casadi.github.io-dev/about/">About</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>


<div id="main" class="container">
  <div class="row">
    <div class="col">

      <p>In this post we'll explore how to couple <a href="https://www.tensorflow.org">Tensorflow</a> and CasADi.
Thanks to Jonas Koch (student @ Applied Mathematics WWU Muenster) for delivering inspiration and example code.</p>
<h1 id="one-dimensional-regression-with-gpflow">One-dimensional regression with GPflow</h1>
<p>An important part of machine learning is about regression: fitting a (non-)linear model through sparse data.
This is an unconstrained optimization problem for which dedicated algorithms and software are readily available.</p>
<p>Let's create some datapoints to fit, a perturbed sine.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">data <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">10</span>,N)<span style="color:#f92672">.</span>reshape((N,<span style="color:#ae81ff">1</span>))
value <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>sin(data)<span style="color:#f92672">+</span>np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>normal(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0.1</span>,(N,<span style="color:#ae81ff">1</span>))
</code></pre></div><p>We make use of <a href="https://github.com/GPflow/GPflow">GPflow</a>, software which is built on top of <a href="https://www.tensorflow.org">Tensorflow</a>, to perform a Gaussian process regression:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">model <span style="color:#f92672">=</span> gpflow<span style="color:#f92672">.</span>models<span style="color:#f92672">.</span>GPR(data, value, gpflow<span style="color:#f92672">.</span>kernels<span style="color:#f92672">.</span>Constant(<span style="color:#ae81ff">1</span>) <span style="color:#f92672">+</span> gpflow<span style="color:#f92672">.</span>kernels<span style="color:#f92672">.</span>Linear(<span style="color:#ae81ff">1</span>) <span style="color:#f92672">+</span> gpflow<span style="color:#f92672">.</span>kernels<span style="color:#f92672">.</span>White(<span style="color:#ae81ff">1</span>) <span style="color:#f92672">+</span> gpflow<span style="color:#f92672">.</span>kernels<span style="color:#f92672">.</span>RBF(<span style="color:#ae81ff">1</span>))
gpflow<span style="color:#f92672">.</span>train<span style="color:#f92672">.</span>ScipyOptimizer()<span style="color:#f92672">.</span>minimize(model)
</code></pre></div><p>The trained model has a <code>predict_y</code> method to deliver us the mean and variance of the fit at any location(s):</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">xf <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">10</span><span style="color:#f92672">*</span>N)<span style="color:#f92672">.</span>reshape((<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>))
[mean,variance] <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>predict_y(xf)
</code></pre></div><figure class=" default">
  <a href="https://asteinh.github.io/casadi.github.io-dev/blog/tensorflow/gpflow1d.png" target="_blank">
<pre><code>&lt;img src=&quot;https://asteinh.github.io/casadi.github.io-dev/blog/tensorflow/gpflow1d.png&quot;  /&gt;
</code></pre>
  </a>
  <figcaption>
    <h1>1D regression example with GPflow</h1>
  </figcaption>
</figure>
<h1 id="embedding-the-regression-model-in-a-casadi-graph">Embedding the regression model in a CasADi graph</h1>
<p>The mechanism for embedding foreign code in CasADi is through the use of a <a href="http://docs.casadi.org/#subclassing-callback">Callback</a>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">GPR</span>(Callback):
  <span style="color:#66d9ef">def</span> __init__(self, name,  opts<span style="color:#f92672">=</span>{}):
    Callback<span style="color:#f92672">.</span>__init__(self)
    self<span style="color:#f92672">.</span>construct(name, opts)

  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">eval</span>(self, arg):
    [mean,_] <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>predict_y(np<span style="color:#f92672">.</span>array(arg[<span style="color:#ae81ff">0</span>]))
    <span style="color:#66d9ef">return</span> [mean]
</code></pre></div><p>After instantiating the Callback, we end up with a plain-old CasADi function object which we can evaluate numerically or symbolically.
One caveat, the user is responsible of keeping at least one reference to this Function.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">gpr <span style="color:#f92672">=</span> GPR(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">GPR</span><span style="color:#e6db74">&#39;</span>, {<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">enable_fd</span><span style="color:#e6db74">&#34;</span>:True})
</code></pre></div><p>As an example of embedding, we can ask Ipopt to compute the minimum of this function.
Finite differences will be used to differentiate the Callback:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">x <span style="color:#f92672">=</span> MX<span style="color:#f92672">.</span>sym(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">x</span><span style="color:#e6db74">&#34;</span>)
solver <span style="color:#f92672">=</span> nlpsol(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">solver</span><span style="color:#e6db74">&#34;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">ipopt</span><span style="color:#e6db74">&#34;</span>,{<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">x</span><span style="color:#e6db74">&#34;</span>:x,<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span>:gpr(x)})
res <span style="color:#f92672">=</span> solver(x0<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span>)
</code></pre></div><figure class=" default">
  <a href="https://asteinh.github.io/casadi.github.io-dev/blog/tensorflow/gpflow1d_min.png" target="_blank">
<pre><code>&lt;img src=&quot;https://asteinh.github.io/casadi.github.io-dev/blog/tensorflow/gpflow1d_min.png&quot;  /&gt;
</code></pre>
  </a>
  <figcaption>
    <h1>1D regression example with GPflow</h1>
  </figcaption>
</figure>
<p>Download code: <a href="gpflow_example.py">gpflow_example.py</a></p>
<h1 id="optimal-control-example-slow">Optimal control example (slow)</h1>
<p>The GPR model from the previous paragraph was a mapping from $R$ to $R$.
To make things more interesting, we will increase the dimension to a mapping from $R^\textrm{nd}$ to $R$.</p>
<p>I didn't have much inspiration to come up with high-dimensional data to fit, so these random arrays will have to do.
Of course, it's rather silly to fit a model through purely random data..</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">data <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>normal(loc<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>,scale<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>,size<span style="color:#f92672">=</span>(N,nd))
value <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>random((N,<span style="color:#ae81ff">1</span>))
model <span style="color:#f92672">=</span> gpflow<span style="color:#f92672">.</span>models<span style="color:#f92672">.</span>GPR(data, value, gpflow<span style="color:#f92672">.</span>kernels<span style="color:#f92672">.</span>Constant(nd) <span style="color:#f92672">+</span> gpflow<span style="color:#f92672">.</span>kernels<span style="color:#f92672">.</span>Linear(nd) <span style="color:#f92672">+</span> gpflow<span style="color:#f92672">.</span>kernels<span style="color:#f92672">.</span>White(nd) <span style="color:#f92672">+</span> gpflow<span style="color:#f92672">.</span>kernels<span style="color:#f92672">.</span>RBF(nd))
</code></pre></div><p>Our callback will need to override the default-scalar sparsity for its input:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">GPR</span>(Callback):
  <span style="color:#66d9ef">def</span> __init__(self, name,  opts<span style="color:#f92672">=</span>{}):
    <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>

  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_sparsity_in</span>(self,i):
      <span style="color:#66d9ef">return</span> Sparsity<span style="color:#f92672">.</span>dense(nd,<span style="color:#ae81ff">1</span>)
</code></pre></div><p>For the remainder, we will just use the code of CasADi's <code>direct_multiple_shooting</code> example, but the solver construction is modified as follows.
The objective is replace by our nd-dimensional model evaluated on the concatenation of all x-states over the optimal control horizon.
We use a limited-memory Hessian approximation here to avoid the cost of obtaining second-order sensitivities.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">w <span style="color:#f92672">=</span> vertcat(<span style="color:#f92672">*</span>w)

prob <span style="color:#f92672">=</span> {<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;</span>: gpr(w[<span style="color:#ae81ff">0</span>::<span style="color:#ae81ff">3</span>]), <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">x</span><span style="color:#e6db74">&#39;</span>: w , <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">g</span><span style="color:#e6db74">&#39;</span>: vertcat(<span style="color:#f92672">*</span>g)}
options <span style="color:#f92672">=</span> {<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">ipopt</span><span style="color:#e6db74">&#34;</span>: {<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">hessian_approximation</span><span style="color:#e6db74">&#34;</span>: <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">limited-memory</span><span style="color:#e6db74">&#34;</span>}}
solver <span style="color:#f92672">=</span> nlpsol(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">solver</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">ipopt</span><span style="color:#e6db74">&#39;</span>, prob,options);
</code></pre></div><p>The problem takes quite some time to solve.
If you look at the timings printout, you'll see that in particular the cost of computing the gradient of the objective (<code>nlp_grad_f</code>) is excessive:</p>
<pre><code>               t_proc [s]   t_wall [s]    n_eval
       nlp_f        0.291        0.261        31
       nlp_g       0.0079      0.00789        31
  nlp_grad_f         25.7         23.2        32
   nlp_jac_g       0.0496       0.0502        32
      solver         26.2         23.6         1
</code></pre><p>If you insert a print statement to inspect the arguments at our Callback's <code>eval</code> method, you'll see the finite differences happening live in your terminal:
each of the <code>nd</code> inputs to <code>gpr</code> is individually perturbed, making the cost to compute the gradient of the objective <code>nd</code> times more expensive than the cost of just the objective.</p>
<p>The solution requires 2783 calls to our Callback, and the Callback ran for a total of 21.7 seconds.</p>
<figure class=" default">
  <a href="https://asteinh.github.io/casadi.github.io-dev/blog/tensorflow/ocp.png" target="_blank">
<pre><code>&lt;img src=&quot;https://asteinh.github.io/casadi.github.io-dev/blog/tensorflow/ocp.png&quot;  /&gt;
</code></pre>
  </a>
  <figcaption>
    <h1>Optimal control example (slow)</h1>
  </figcaption>
</figure>
<p>Download code: <a href="ocp.py">ocp.py</a></p>
<h1 id="optimal-control-example-fast">Optimal control example (fast)</h1>
<p>We'll speed up our code on two fronts:</p>
<p>First, we notice that <code>predict_y</code> incurs quite some overhead. Instead of calling it repeatedly, let's work with the underlying Tensorflow graphs:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">X <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>placeholder(shape<span style="color:#f92672">=</span>(<span style="color:#ae81ff">1</span>,nd),dtype<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>float64)
[mean,_] <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>_build_predict(X)
</code></pre></div><p>Running this <code>mean</code> graph in a tensorflow session has much less overhead:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> tensorflow <span style="color:#f92672">as</span> tf
<span style="color:#66d9ef">with</span> tf<span style="color:#f92672">.</span>Session() <span style="color:#66d9ef">as</span> session:
  session<span style="color:#f92672">.</span>run(mean, feed_dict(X: np<span style="color:#f92672">.</span>array(<span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>)))
</code></pre></div><p>Second, we notice that tensorflow supports algorithmic differentation.
If we add a reverse mode implementation to our Callback, we can get the gradient for (a small multiple of) the cost of the objective.
Note that (vanilla) Tensorflow offers only the reverse mode of AD, not the forward mode.
This is logical, since it focusses on unconstrained optimization.</p>
<p>It's quite easy to create a general purpose <code>TensorFlowEvaluator</code> Callback (<a href="tensorflow_casadi.py">tensorflow_casadi.py</a> for full code):</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">TensorFlowEvaluator</span>(casadi<span style="color:#f92672">.</span>Callback):
  <span style="color:#66d9ef">def</span> __init__(self,t_in,t_out,session, opts<span style="color:#f92672">=</span>{}):
    <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>

  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">eval</span>(self,arg):
    <span style="color:#75715e"># Associate each tensorflow input with the numerical argument passed by CasADi</span>
    d <span style="color:#f92672">=</span> dict((v,arg[i]<span style="color:#f92672">.</span>toarray()) <span style="color:#66d9ef">for</span> i,v <span style="color:#f92672">in</span> enumerate(self<span style="color:#f92672">.</span>t_in))
    <span style="color:#75715e"># Evaluate the tensorflow expressions</span>
    ret <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>session<span style="color:#f92672">.</span>run(self<span style="color:#f92672">.</span>t_out,feed_dict<span style="color:#f92672">=</span>d)
    <span style="color:#66d9ef">return</span> ret

  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">has_reverse</span>(self,nadj): <span style="color:#66d9ef">return</span> nadj<span style="color:#f92672">==</span><span style="color:#ae81ff">1</span>
  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_reverse</span>(self,nadj,name,inames,onames,opts):
    <span style="color:#75715e"># Construct tensorflow placeholders for the reverse seeds</span>
    adj_seed <span style="color:#f92672">=</span> [tf<span style="color:#f92672">.</span>placeholder(shape<span style="color:#f92672">=</span>self<span style="color:#f92672">.</span>sparsity_out(i)<span style="color:#f92672">.</span>shape,dtype<span style="color:#f92672">=</span>tf<span style="color:#f92672">.</span>float64) <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(self<span style="color:#f92672">.</span>n_out())]
    <span style="color:#75715e"># Construct the reverse tensorflow graph through &#39;gradients&#39;</span>
    grad <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>gradients(self<span style="color:#f92672">.</span>t_out, self<span style="color:#f92672">.</span>t_in,grad_ys<span style="color:#f92672">=</span>adj_seed)
    <span style="color:#75715e"># Create another TensorFlowEvaluator object</span>
    callback <span style="color:#f92672">=</span> TensorFlowEvaluator(self<span style="color:#f92672">.</span>t_in<span style="color:#f92672">+</span>adj_seed,grad,self<span style="color:#f92672">.</span>session)
    <span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>
</code></pre></div><p>With these two modifications in place, the solution requires just 63 calls to our Callback, for a total Callback runtime of 0.13 seconds.</p>
<p>Download code: <a href="ocp_faster.py">ocp_faster.py</a>, <a href="tensorflow_casadi.py">tensorflow_casadi.py</a></p>
<p>In conclusion, we've shown how to embed calls to foreign code in CasADi graphs.
Though the optimal control example is contrived, it conveys how such coupling can be made efficient.</p>
<p>To learn more ways to endow sensitivity-information on a Callback, see the <a href="https://github.com/casadi/casadi/blob/develop/docs/examples/python/callback.py">callback.py example</a>.</p>

      <div class="card-columns">
        
          
            
            <div class="card border-success">
            
              
                <img class="card-img-top" src="https://asteinh.github.io/casadi.github.io-dev/blog/mpc-simulink2/mpc_diagram.png" alt="Card image cap" />
              
              <div class="card-body">
                <h5 class="card-title">CasADi-driven MPC in Simulink (part 2)</h5>
                <p>In this post, we have a new take on nonlinear MPC in Simulink using CasADi.</p>
                <a href="https://asteinh.github.io/casadi.github.io-dev/blog/mpc-simulink2/" class="btn btn-primary">Read more</a>
              </div>
              <div class="card-footer text-muted text-right">
                <span class="reading-time-short text-muted"><i class="fa fa-clock-o"></i>3 mins</span>

                posted December 19, 2019
              </div>
            </div>
          
        
          
            
            <div class="card">
            
              
                <img class="card-img-top" src="https://asteinh.github.io/casadi.github.io-dev/blog/nlp_sens/nlp_1d.png" alt="Card image cap" />
              
              <div class="card-body">
                <h5 class="card-title">Sensitivities of parametric NLP</h5>
                <p>In this post, we explore the parametric sensitivities of a nonlinear program (NLP).
While we use &lsquo;Opti stack&rsquo; syntax for modeling, differentiability of NLP solvers works all the same without Opti.</p>
                <a href="https://asteinh.github.io/casadi.github.io-dev/blog/nlp_sens/" class="btn btn-primary">Read more</a>
              </div>
              <div class="card-footer text-muted text-right">
                <span class="reading-time-short text-muted"><i class="fa fa-clock-o"></i>3 mins</span>

                posted October 28, 2019
              </div>
            </div>
          
        
          
            
            <div class="card">
            
              
                <img class="card-img-top" src="https://asteinh.github.io/casadi.github.io-dev/blog/parfor/parfor1.png" alt="Card image cap" />
              
              <div class="card-body">
                <h5 class="card-title">Parfor</h5>
                <p>In this post we'll explore how to use Matlab's parfor with a CasADi nonlinear program.</p>
                <a href="https://asteinh.github.io/casadi.github.io-dev/blog/parfor/" class="btn btn-primary">Read more</a>
              </div>
              <div class="card-footer text-muted text-right">
                <span class="reading-time-short text-muted"><i class="fa fa-clock-o"></i>3 mins</span>

                posted August 23, 2018
              </div>
            </div>
          
        
          
            
            <div class="card">
            
              
                <img class="card-img-top" src="https://asteinh.github.io/casadi.github.io-dev/blog/tensorflow/gpflow1d_min.png" alt="Card image cap" />
              
              <div class="card-body">
                <h5 class="card-title">Tensorflow and CasADi</h5>
                <p>In this post we'll explore how to couple <a href="https://www.tensorflow.org">Tensorflow</a> and CasADi.
Thanks to Jonas Koch (student @ Applied Mathematics WWU Muenster) for delivering inspiration and example code.</p>
                <a href="https://asteinh.github.io/casadi.github.io-dev/blog/tensorflow/" class="btn btn-primary">Read more</a>
              </div>
              <div class="card-footer text-muted text-right">
                <span class="reading-time-short text-muted"><i class="fa fa-clock-o"></i>5 mins</span>

                posted July 30, 2018
              </div>
            </div>
          
        
          
            
            <div class="card">
            
              
              <div class="card-body">
                <h5 class="card-title">Breaking free of CasADi&#39;s solvers</h5>
                <p>Once you've modeled your optimization problem in CasADi,
you don't have to stick to the solvers we interface.</p>
<p>In this post, we briefly demonstrate how we can make CasADi and Matlab's <code>fmincon</code> cooperate.</p>
                <a href="https://asteinh.github.io/casadi.github.io-dev/blog/fmincon/" class="btn btn-primary">Read more</a>
              </div>
              <div class="card-footer text-muted text-right">
                <span class="reading-time-short text-muted"><i class="fa fa-clock-o"></i>3 mins</span>

                posted July 13, 2018
              </div>
            </div>
          
        
          
            
            <div class="card">
            
              
                <img class="card-img-top" src="https://asteinh.github.io/casadi.github.io-dev/blog/s-function/simulink.png" alt="Card image cap" />
              
              <div class="card-body">
                <h5 class="card-title">CasADi codegen and S-Functions</h5>
                <p>While the <a href="http://docs.casadi.org">user guide</a> does explain code-generation in full detail,
it is handy to have a demonstration in a real environment like Matlab's S-functions.</p>
                <a href="https://asteinh.github.io/casadi.github.io-dev/blog/s-function/" class="btn btn-primary">Read more</a>
              </div>
              <div class="card-footer text-muted text-right">
                <span class="reading-time-short text-muted"><i class="fa fa-clock-o"></i>3 mins</span>

                posted July 13, 2018
              </div>
            </div>
          
        
          
            
            <div class="card">
            
              
                <img class="card-img-top" src="https://asteinh.github.io/casadi.github.io-dev/blog/nlp-scaling/conv.png" alt="Card image cap" />
              
              <div class="card-body">
                <h5 class="card-title">On the importance of NLP scaling</h5>
                <p>During my master's thesis at KULeuven on optimal control, one of the take-aways were that it's important to scale your variables. It helps convergence if the variables are in the order of 0.01 to 100.</p>
                <a href="https://asteinh.github.io/casadi.github.io-dev/blog/nlp-scaling/" class="btn btn-primary">Read more</a>
              </div>
              <div class="card-footer text-muted text-right">
                <span class="reading-time-short text-muted"><i class="fa fa-clock-o"></i>2 mins</span>

                posted September 15, 2017
              </div>
            </div>
          
        
          
            
            <div class="card">
            
              
                <img class="card-img-top" src="https://asteinh.github.io/casadi.github.io-dev/blog/ocp/hyperworks-industries-architecture-screen-capture-6-726x383.jpg" alt="Card image cap" />
              
              <div class="card-body">
                <h5 class="card-title">Optimal control problems in a nutshell</h5>
                <p>Optimization.
There's a mathematical term that sounds familiar to the general public.
Everyone can imagine engineers working hard to make your car run 1% more fuel-efficient,
or to slightly increase profit margins for a chemical company.</p>
                <a href="https://asteinh.github.io/casadi.github.io-dev/blog/ocp/" class="btn btn-primary">Read more</a>
              </div>
              <div class="card-footer text-muted text-right">
                <span class="reading-time-short text-muted"><i class="fa fa-clock-o"></i>5 mins</span>

                posted September 15, 2017
              </div>
            </div>
          
        
          
            
            <div class="card">
            
              
                <img class="card-img-top" src="https://asteinh.github.io/casadi.github.io-dev/blog/opti/rosenbrock1.png" alt="Card image cap" />
              
              <div class="card-body">
                <h5 class="card-title">Easy NLP modeling in CasADi with Opti</h5>
                <p><a href="http://install33.casadi.org">Release 3.3.0</a> of CasADi introduced a compact syntax for NLP modeling, using a set of helper classes, collectively known as &lsquo;Opti stack&rsquo;.</p>
<p>In this post, we briefly demonstrates this functionality.</p>
                <a href="https://asteinh.github.io/casadi.github.io-dev/blog/opti/" class="btn btn-primary">Read more</a>
              </div>
              <div class="card-footer text-muted text-right">
                <span class="reading-time-short text-muted"><i class="fa fa-clock-o"></i>3 mins</span>

                posted September 14, 2017
              </div>
            </div>
          
        
          
            
            <div class="card">
            
              
                <img class="card-img-top" src="https://asteinh.github.io/casadi.github.io-dev/blog/mpc-simulink/simulink_block.png" alt="Card image cap" />
              
              <div class="card-body">
                <h5 class="card-title">CasADi-driven MPC in Simulink (part 1)</h5>
                <p>CasADi is not a monolithic tool. We can easily couple it to other software to have more fun.
Today we'll be exploring a <em>simple</em> coupling with Simulink. We'll be showing off nonlinear MPC (NMPC).</p>
                <a href="https://asteinh.github.io/casadi.github.io-dev/blog/mpc-simulink/" class="btn btn-primary">Read more</a>
              </div>
              <div class="card-footer text-muted text-right">
                <span class="reading-time-short text-muted"><i class="fa fa-clock-o"></i>4 mins</span>

                posted March 8, 2017
              </div>
            </div>
          
        
          
        
      </div>
    </div>
  </div>
</div>

    <footer>
      <div class="container">
        <div class="row justify-content-md-center">
          <div class="col-md-auto text-center">
            <ul id="social" class="list-inline">
              
                <li class="list-inline-item">
                  <a href="https://github.com/casadi/casadi" title="github">
                    <i class="fa fa-github"></i>
                  </a>
                </li>
              
                <li class="list-inline-item">
                  <a href="https://twitter.com/casadi_software" title="twitter">
                    <i class="fa fa-twitter"></i>
                  </a>
                </li>
              
                <li class="list-inline-item">
                  <a href="https://www.youtube.com/channel/UC3VDpv5Pi3R-a2VkcJN1RLw" title="youtube">
                    <i class="fa fa-youtube"></i>
                  </a>
                </li>
              
            </ul>
            <p class="copyright">Copyright 2020.</p>
          </div>
        </div>
      </div>
    </footer>

    
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

    
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>

    
    <script src="https://asteinh.github.io/casadi.github.io-dev/_js/bootstrap.min.js"></script>

    
    <script src="https://asteinh.github.io/casadi.github.io-dev/_js/scripts.js"></script>

    
    <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS_CHTML">
</script>

    
  </body>

</html>

